This is a modified version.

Only a few controls, styles and attached attributes are left for later use.